<!--
	此示例下载自 https://echarts.apache.org/examples/zh/editor.html?c=line-race&lang=js&code=CQOg5gpgLgFAUAAgQJQPKoCoH0AKBBDACQQGoEByAegBMBDKWy2gZ2ehvsYBsBLAMwgBaCAA8ADhADGDAHaSAnoIYAjLhBAArZgHsZ5ADSIEfAK5yoPXQhhYATrQDuAEU4BKBAG8jSW2Zv3nNwBuIwBfOFcQ03NLGQRfGX9HFwZ3LyRKSgQAN1pbBEltMyhbHghmBABeBABtcjwTZhLaXloDCgBhWhlaOnbyDoALHh7-jpNlNv0KADERrm7qfpn7OQh-gHEIWwBbbvl-gElJCAWZJenyQ_OeKYoAKVoxbv6AOW1bKEGEAGkPiDu5AAykUvr9_oDXhAHAgAFoAs4XCjvWwOWgHS44bSI_rIRrMW79DAmWwAawgGIoAFUZDwoBBqL8RmBqNodv0aXSGQggQx6cxyABdEJIQoyJoFIoyEplCrVGreWbzRYGRXkFbdE6qpBIchbXb7bU6q4nHGGHXIj5ojFqrFmtV41iE83Gzn0xk_Zms9lGYVGMUSugMNhQADqdMGcy49NsctqftFuglbFK5QAMjwJfKEwgpIM8lBmCATBYuCAAZJBjBCsVU8xptFpLFrDXpbZ5GlFbl8kGWNBDozquReyGsORSJLa_IRTqR9Bw18ozGi2JGlX0haEDxqAAuBBzqADl0Wvi2NkpPuH3cUA92RxGi3NcV8D47PcbzcIKDyCR78h8Hho22B9NzFACwHfRVP0WPcFU_T8PH3HgdggcVYj_ABNAFbHaMB6T3ABGABOABWAAGBBQmPeCkEQ6hkNQgldD_DopRKSlyEqcg91bdjKKgzdBQEpBwk_USdVCSJFRTWUMyaEBV2YdcBO_X8KF4GR1mopADwHPddOobSECU7QHCBeQdmUbE9z4Fo2CMnoUJ4tj2yM1DqDTWhlFOSCaJMhw9xKEwICMpAXwNKAYxsswmysGBnnsHZmE7GifGgEk4gS2gkpAXIuGCmoAGZBQnbiKAnLKcrygqyJzMSBKogSFm8rhPPkUFfPgnZtGyCBUF62wFjEP8lP4KAMPIBq3J2MR8wJZhOs_F9JEaEbtllSaxLcuRtGoCBFs3ERMOwkCLXkP9rkKFDTp1ZqfNqAYXI4y62XWQVQq3ekdlebL9ooLC8hupAoG0bELGGh6XuuoT6otSSZ3hoxtDECwrGqD8EG6ZD6FiJwSRx5iEAIsiSbI6iD1ggSMYtbc_1vAIgeMopbBOPc70CBgpoEkAeYPBdI0A5dFXexULCgNQDuB0QoAunaUIQbQ-AQfU9hkeRMfOBANTWYyRhOInSLIzaJOokGwZ4CHqYV2w9tsP9qogJxykkG6ZTASA7YoWgREzY2ROokQ8B9hbPBUn8_vISR6AgMAPhtT9HIgNNtCj1GZD_HZt2oNQ_co6j5CDzNJYQRPZau9ZFUai0wFKa8rdKMBBhlomABYyMr6iZPKPcu-YOSoDCGcdnkIYCxAENUBR2IYGRtOpNCIA
	⚠ 请注意，该图表不是 Apache ECharts 官方示例，而是由用户代码生成的。请注意鉴别其内容。
-->
<!DOCTYPE html>
<html lang="zh-CN" style="height: 100%">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
    <title>ACSA力扣周赛排名</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
</head>

<body style="height: 100%; margin: 0">
    <div id="title"><center><h1 style="font-size:50px; color:black;font-family: Garamond">Leetcode contest ranking</h1></center></div>
    
    <div id="container" style="height:50%; width: 100%;"></div>
    <div id="container2" style="height:50%;width: 90%;margin: 5%"></div>


    
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/jquery"></script>
    <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/echarts.min.js"></script>
    <!-- Uncomment this line if you want to dataTool extension
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/dataTool.min.js"></script>
      -->
    <!-- Uncomment this line if you want to use gl extension
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-gl@2/dist/echarts-gl.min.js"></script>
      -->
    <!-- Uncomment this line if you want to echarts-stat extension
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts-stat@latest/dist/ecStat.min.js"></script>
      -->
    <!-- Uncomment this line if you want to use map
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/china.js"></script>
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@4.9.0/map/js/world.js"></script>
      -->
    <!-- Uncomment these two lines if you want to use bmap extension
      <script type="text/javascript" src="https://api.map.baidu.com/api?v=3.0&ak=YOUR_API_KEY"></script>
      <script type="text/javascript" src="https://fastly.jsdelivr.net/npm/echarts@5.4.2/dist/extension/bmap.min.js"></script>
      -->

    <script type="text/javascript">
        function createChart(divId) {
        var dom = document.getElementById(divId);
        var myChart = echarts.init(dom, null, {
            renderer: 'canvas',
            useDirtyRect: false
        });
        var app = {};
        var ROOT_PATH = 'https://echarts.apache.org/examples';
        var option;

        $.get(
            // './leetcode.json',
            './my_list.json',

            function (_rawData) {
                run(_rawData);
            }
        );
        function run(_rawData) {
            // var countries = ['Australia', 'Canada', 'China', 'Cuba', 'Finland', 'France', 'Germany', 'Iceland', 'India', 'Japan', 'North Korea', 'South Korea', 'New Zealand', 'Norway', 'Poland', 'Russia', 'Turkey', 'United Kingdom', 'United States'];
            const peoples = [
                // TODO: 人员
                '谭邵杰',
                '曹振伟',
                '沈沛祺',
                '黄业琦',
                '袁福焱',
                '林坤贤',
                '付佳伟'
            ];
            const datasetWithFilters = [];
            const seriesList = [];
            echarts.util.each(peoples, function (name) {
                var datasetId = 'dataset_' + name;
                datasetWithFilters.push({
                    id: datasetId,
                    fromDatasetId: 'dataset_raw',
                    transform: {
                        type: 'filter',
                        config: {
                            and: [
                                {
                                    dimension: 'contest number',
                                    gte: 300
                                },
                                {
                                    dimension: 'Name',
                                    '=': name
                                }
                            ]
                        }
                    }
                });
                seriesList.push({
                    type: 'line',
                    datasetId: datasetId,
                    showSymbol: false,
                    name: name,
                    endLabel: {
                        show: true,
                        formatter: function (params) {
                            // Name + score
                            return params.value[1] + ': ' + params.value[0];
                        }
                    },
                    labelLayout: {
                        moveOverlap: 'shiftY'
                    },
                    emphasis: {
                        focus: 'series'
                    },
                    encode: {
                        x: 'contest name',
                        y: 'score',
                        label: ['Name', 'score'],
                        itemName: 'contest number',
                        tooltip: ['score']
                    },
                    markPoint: {
                        data: [
                            // { type: 'max', name: '' }
                            // { type: 'min', name: 'Min' }
                        ]
                    }
                });
            });
            option = {
                animationDuration: 10000,
                dataset: [
                    {
                        id: 'dataset_raw',
                        source: _rawData
                    },
                    ...datasetWithFilters
                ],
                title: {
                    // text: 'Leetcode contest ranking'
                },
                tooltip: {
                    order: 'valueDesc',
                    trigger: 'axis'
                },
                toolbox: {
                    show: true,
                    feature: {
                        dataZoom: {
                        yAxisIndex: 'none'
                        },
                        dataView: { readOnly: false },
                        magicType: { type: ['line', 'bar'] },
                        restore: {},
                        saveAsImage: {}
                    }
                },
                xAxis: {
                    type: 'category',
                    name: '',
                    nameLocation: 'middle'
                },
                yAxis: {
                    name: '竞赛分数',
                    min:1450,
                    splitNumber: 10
                },
                grid: {
                    right: 140
                },
                series: seriesList
            };
            myChart.setOption(option);
        }


        if (option && typeof option === 'object') {
            myChart.setOption(option);
        }

        window.addEventListener('resize', myChart.resize);
    }
        createChart('container');
    </script>

    <script type="text/javascript">
        var dom = document.getElementById('container2');
        var myChart = echarts.init(dom, null, {
            renderer: 'canvas',
            useDirtyRect: false
        });
        var app = {};
        var ROOT_PATH = 'https://echarts.apache.org/examples';
        var option;

        const updateFrequency = 570;
        const dimension = 0;
        const countryColors = {
            // TODO: 人员
            '谭邵杰': '#224ac6',
            '曹振伟': '#92cd77',
            '沈沛祺': '#fac858',
            '黄业琦': '#ee6666',
            '袁福焱': '#73c0de',
            '林坤贤': '#3ba272',
            '付佳伟': '#3ba272',
            Australia: '#00008b',
            Canada: '#f00',
            China: '#ffde00',
            Cuba: '#002a8f',
            Finland: '#003580',
            France: '#ed2939',
            Germany: '#000',
            Iceland: '#003897',
            India: '#f93',
            Japan: '#bc002d',
            'North Korea': '#024fa2',
            'South Korea': '#000',
            'New Zealand': '#00247d',
            Norway: '#ef2b2d',
            Poland: '#dc143c',
            Russia: '#d52b1e',
            Turkey: '#e30a17',
            'United Kingdom': '#00247d',
            'United States': '#b22234'
        };
        $.when(
            $.getJSON('./life-data.json'),
            $.getJSON('./my_list.json')
        ).done(function (res0, res1) {
            // const flags = res0[0];
            const data = res1[0];
            const contestName = [];
            for (let i = 0; i < data.length; ++i) {
                if (contestName.length === 0 || contestName[contestName.length - 1] !== data[i][3]) {
                    contestName.push(data[i][3]);
                }
            }
            // function getFlag(countryName) {
            //     if (!countryName) {
            //         return '';
            //     }
            //     return (
            //         flags.find(function (item) {
            //             return item.name === countryName;
            //         }) || {}
            //     ).emoji;
            // }
            let startIndex = 0;
            let startContestName = contestName[startIndex];
            option = {
                grid: {
                    top: 10,
                    bottom: 30,
                    left: 150,
                    right: 80
                },
                toolbox: {
                    show: true,
                    feature: {
                        dataZoom: {
                        yAxisIndex: 'none'
                        },
                        dataView: { readOnly: false },
                        magicType: { type: ['line', 'bar'] },
                        restore: {},
                        saveAsImage: {}
                    }
                },
                xAxis: {
                    max: 'dataMax',
                    axisLabel: {
                        formatter: function (n) {
                            return Math.round(n) + '';
                        }
                    }
                },
                dataset: {
                    source: data.slice(1).filter(function (d) {
                        return d[3] === startContestName;
                    })
                },
                yAxis: {
                    type: 'category',
                    inverse: true,
                    // TODO: 人数 7 人, 写6 [0-6]
                    max: 6,
                    axisLabel: {
                        show: true,
                        fontSize: 14,
                        formatter: function (value) {
                            // return value + '{flag|232' + getFlag(value) + '}';
                            return value + '{flag|:}';
                        },
                        rich: {
                            flag: {
                                fontSize: 25,
                                padding: 5
                            }
                        }
                    },
                    animationDuration: 300,
                    animationDurationUpdate: 300
                },
                series: [
                    {
                        realtimeSort: true,
                        seriesLayoutBy: 'column',
                        type: 'bar',
                        itemStyle: {
                            color: function (param) {
                                return countryColors[param.value[1]] || '#5470c6';
                            }
                        },
                        encode: {
                            x: dimension,
                            y: 1
                        },
                        label: {
                            show: true,
                            precision: 1,
                            position: 'right',
                            valueAnimation: true,
                            fontFamily: 'monospace'
                        }
                    }
                ],
                // Disable init animation.
                animationDuration: 0,
                animationDurationUpdate: updateFrequency,
                animationEasing: 'linear',
                animationEasingUpdate: 'linear',
                graphic: {
                    elements: [
                        {
                            type: 'text',
                            right: 160,
                            bottom: 60,
                            style: {
                                text: startContestName,
                                font: 'bolder 80px monospace',
                                fill: 'rgba(100, 100, 100, 0.5)'
                            },
                            z: 100
                        }
                    ]
                }
            };
            // console.log(option);
            myChart.setOption(option);
            for (let i = startIndex; i < contestName.length - 1; ++i) {
                (function (i) {
                    setTimeout(function () {
                        updateYear(contestName[i + 1]);
                    }, (i - startIndex) * updateFrequency);
                })(i);
            }
            function updateYear(year) {
                let source = data.slice(1).filter(function (d) {
                    return d[3] === year;
                });
                option.series[0].data = source;
                option.graphic.elements[0].style.text = year;
                myChart.setOption(option);
            }
        });

        if (option && typeof option === 'object') {
            myChart.setOption(option);
        }

        window.addEventListener('resize', myChart.resize);
    </script>
</body>

</html>